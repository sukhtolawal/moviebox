!function(e,t){const n=Date.now();try{let n={};n.log=e.console.log;let f=0,u=0,g=0,m=[0,0,0],T=!1,y=!1,h=!1,L=null,p=0,v=0,w=5,E=null,S=0,C=15,I=!1,x=30,D=10;const R=5;let _=-1,N=!1,H="",M=!1,P="",O=!1,b=null,A=null,F=(new Date,null),G=null,V=null,J=null,$=!1,z="",B=null,W=!1,j=!1,q=!1,U=0;const k=30;let K=0;const Q="h5game_preformance_monitor",X="session",Y="event",Z="StartMonitor",ee="gameReady",te="gameStart",ne="fps",oe="time",ae="value";function o(){n.log("@@@@@ webpage loaded!"),F=new Date,I=!0}function a(){if(r(e),c(e),s(e),t){let e=t.querySelectorAll("iframe");for(let t=0;t<e.length;t++){let n=e[t];r(n.contentWindow),c(n.contentWindow),s(n.contentWindow)}}}function r(e){try{if(!e.HTMLCanvasElement||e.HTMLCanvasElement.prototype.getContextType)return}catch(e){return}e.addEventListener("touchstart",l),e.addEventListener("touchmove",l),e.addEventListener("touchend",l),e.HTMLCanvasElement.prototype._getContext=e.HTMLCanvasElement.prototype.getContext,e.HTMLCanvasElement.prototype._contextType="",e.HTMLCanvasElement.prototype.getContext=function(t,o){n.log("@@@@@ try to get canvas context ",t);let a=e.HTMLCanvasElement.prototype._getContext.call(this,t,o);return a&&(this._contextType=t,"webgl"!=t&&"webgl2"!=t||function(e){if(e.isAdapted)return;n.log("adapting canvas context...");const t={};t[e.POINTS]={ndx:0,fn:e=>e},t[e.LINE_LOOP]={ndx:1,fn:e=>e},t[e.LINE_STRIP]={ndx:1,fn:e=>e-1},t[e.LINES]={ndx:1,fn:e=>e/2|0},t[e.TRIANGLE_STRIP]={ndx:2,fn:e=>e-2},t[e.TRIANGLE_FAN]={ndx:2,fn:e=>e-2},t[e.TRIANGLES]={ndx:2,fn:e=>e/3|0};var o=e.drawElements;e.drawElements=function(e,n,a,r){o.call(this,e,n,a,r);const l=t[e];m[l.ndx]+=l.fn(n),f+=n};var a=e.drawArrays;e.drawArrays=function(e,n,o){a.call(this,e,n,o);const r=t[e];m[r.ndx]+=r.fn(o),f+=o};var r=e.clear;e.clear=function(e){r.call(this,e),p+=1},e.canvas.addEventListener("touchstart",i),e.canvas.addEventListener("touchmove",i),e.canvas.addEventListener("touchend",i),e.isAdapted=!0}(a)),a},n.log("adapt canvas ",e.HTMLCanvasElement),e.HTMLCanvasElement.prototype.getContextType=function(){return this._contextType}}function l(){i()}function i(){n.log("~~~"),h||(y?(h=!0,J=new Date):T?L||(L=new Date):E=new Date)}function c(e){try{if(e.__hasListenResourceFetching||!e.PerformanceObserver)return}catch(e){return}n.log("@@@ listenResourceFetching ",e);new e.PerformanceObserver(d).observe({type:"resource",buffered:!0,durationThreshold:16}),e.__hasListenResourceFetching=!0}function d(e){let t=e.getEntries();for(let e=0;e<t.length;e++){const o=t[e];o.name===H&&(M=!0),"ping"!=o.initiatorType&&"beacon"!=o.initiatorType&&(o.decodedBodySize&&o.decodedBodySize>0&&(n.log("-> loaded : ",o.name,o.decodedBodySize),v=0,S=0))}}function s(e){if(e&&""!=P&&!O)try{let t=e.document;if(b)A==t&&b.getRootNode()!=t&&(O=!0);else{let e=t.querySelectorAll(P)[0];e&&(b=e,A=t)}}catch(e){}}n.log("in game_preformance_monitor_1.js top function()"),function(){n.log("in game_preformance_monitor_1.js setup()");try{e.dltLocalChannel&&e.dltLocalChannel.report instanceof Function&&(B=function(t,n,o,a){e.dltLocalChannel.report(t,n,o,a)})}catch(e){B=null}try{e.dltLocalChannel&&e.dltLocalChannel.gamePerformanceMonitorGetSessionId instanceof Function&&(z=e.dltLocalChannel.gamePerformanceMonitorGetSessionId())}catch(e){z=""}n.log("sessionId = ",z);let r={};try{let t="{}";e.dltLocalChannel&&e.dltLocalChannel.gamePerformanceMonitorGetStr instanceof Function&&(t=atob(e.dltLocalChannel.gamePerformanceMonitorGetStr()),$=!0),r=JSON.parse(t)}catch(e){r={}}if(n.log("config = ",JSON.stringify(r)),r&&r["*"]){let e=r["*"];_=e.targetVectexPreFrame||_,H=e.targetResourceUrl||H,P=e.targetElementId||P,D=e.renderReadyVecIncTH||D,x=e.renderReadyMinVecTH||x,w=e.renderReadyIdleLoadTimeTH||w,C=e.overallIdleLoadTimeTH||C}if(r&&r[location.href]){let e=r[location.href];_=e.targetVectexPreFrame||_,H=e.targetResourceUrl||H,P=e.targetElementId||P,D=e.renderReadyVecIncTH||D,x=e.renderReadyMinVecTH||x,w=e.renderReadyIdleLoadTimeTH||w,C=e.overallIdleLoadTimeTH||C}if(B){let e={};e[X]=z,e[Y]=Z,e[oe]=(new Date).getTime(),e[ae]=null,n.log("reportFunc = ",B),B(Q,JSON.stringify(e),0,3755),W=!0}new MutationObserver(a).observe(t.getRootNode(),{childList:!0,subtree:!0}),setInterval((()=>{!function(){let e=0==p?1:p;if(!y){if(n.log(`    VERTS: ${f}\n                    POINTS: ${m[0]}\n                    LINES: ${m[1]}\n                    TRIANGLES: ${m[2]}\n                    \n                    FPS: ${p}`),f>0&&e>=R){let t=f/e;if(0!=u){t/(u/g)>D&&(T=!0,G=new Date)}T||t>=x&&(T=!0,G=new Date),-1!=_&&t>=_&&(N=!0,y=!0,V=new Date)}y||(T?((v>=w||-1==w)&&(y=!0,V=new Date((new Date).getTime()-1e3*w),L&&(new Date).getTime()-L.getTime()<1e3*w&&(h=!0,J=L)),y||""!=H&&M&&(y=!0,V=new Date),y||""!=P&&b&&O&&(y=!0,b=null,V=new Date)):I&&(S>=C&&-1!=C&&(y=!0,V=new Date((new Date).getTime()-1e3*C),E&&(new Date).getTime()-E.getTime()<1e3*C&&(h=!0,J=E)),y||""!=H&&M&&(y=!0,V=new Date),y||""!=P&&b&&O&&(y=!0,b=null,V=new Date)))}if(!j&&y&&B){let e={};e[X]=z,e[Y]=ee,e[oe]=V?V.getTime():0,e[ae]=null,B(Q,JSON.stringify(e),0,3755),j=!0}if(!q&&h&&B){let e={};e[X]=z,e[Y]=te,e[oe]=J?J.getTime():0,e[ae]=null,B(Q,JSON.stringify(e),0,3755),q=!0}if(K<=0&&(K=k,B)){let t={};t[X]=z,t[Y]=ne,t[oe]=(new Date).getTime(),t[ae]=e,B(Q,JSON.stringify(t),0,3755),U+=1}K-=1}(),m[0]=m[1]=m[2]=0,u=f,f=0,g=p,p=0,T&&(v+=1),S+=1}),1e3),e.addEventListener("load",o)}()}catch(e){}Date.now()}(window,document);